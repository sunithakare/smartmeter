
<div fxLayout="column" class="mat-body-2" id="content1">
    <form [formGroup]="userdetails" autocomplete="off">
      <mat-card>
        <mat-card-title style="color: white; background-color: #014b88" ><h4 style="margin-left: 10px">User Details</h4></mat-card-title >
            <div fxLayout="row" fxLayoutAlign="space-around center">
                <mat-form-field appearance="fill">
                  <mat-label>Salutation</mat-label>
                  <mat-select formControlName="salutation" >
                    <mat-option  value="Mr">Mr</mat-option>
                    <mat-option  value="Ms">Ms</mat-option>
                    <mat-option  value="Mrs">Mrs</mat-option>
                    <mat-option  value="Dr">Dr</mat-option>
                  </mat-select>

                  <mat-error
                    *ngIf="userdetails.controls['salutation'].hasError('required')"
                  >
                  Salutation is <strong>required</strong>
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                  <mat-label>First Name</mat-label>
                  <input type="text" matInput formControlName="firstName" />
                  <mat-error
                    *ngIf="userdetails.controls['firstName'].hasError('required')"
                  >
                    First Name is <strong>required</strong>
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                  <mat-label>Last Name</mat-label>
                  <input type="text" matInput formControlName="lastName" />
                  <mat-error
                    *ngIf="userdetails.controls['lastName'].hasError('required')"
                  >
                    Last Name is <strong>required</strong>
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                  <mat-label>Email</mat-label>
                  <input type="text" matInput formControlName="email" />
                  <mat-error
                    *ngIf="userdetails.controls['email'].hasError('required')"
                  >
                    Email is <strong>required</strong>
                  </mat-error>
                  <mat-error
                    *ngIf="userdetails.controls['email'].hasError('email')"
                  >
                    Email is <strong>Invalid</strong>
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                  <mat-label>Mobile No</mat-label>
                  <input type="text" matInput formControlName="mobileNo" />
                  <mat-error
                    *ngIf="userdetails.controls['mobileNo'].hasError('required')"
                  >
                  Mobile No is <strong>required</strong>
                  </mat-error>
                  <mat-error
                    *ngIf="userdetails.controls['mobileNo'].hasError('pattern')"
                  >
                  Mobile No is <strong>Invalid</strong>
                  </mat-error>
                </mat-form-field>
            </div>


      </mat-card>
    </form>

    <form [formGroup]="employmentDetails" autocomplete="off">
      <mat-card>
        <mat-card-title style="color: white; background-color: #014b88" ><h4 style="margin-left: 10px">Employment Details</h4></mat-card-title >
        <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="20px">

          <mat-form-field appearance="fill">
            <mat-label>Employee Id</mat-label>
            <input type="text" matInput formControlName="employeeId" />
            <mat-error
              *ngIf="employmentDetails.controls['employeeId'].hasError('required')"
            >
            Employee Id is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Designation</mat-label>
            <input type="text" matInput formControlName="designation" />
            <mat-error
              *ngIf="employmentDetails.controls['designation'].hasError('required')"
            >
            Designation is <strong>required</strong>
            </mat-error>
          </mat-form-field>


          <mat-form-field appearance="fill">
            <mat-label>Department</mat-label>
            <input type="text" matInput formControlName="department" />
            <mat-error
              *ngIf="employmentDetails.controls['department'].hasError('required')"
            >
            Department is <strong>required</strong>
            </mat-error>
          </mat-form-field>

        </div>


      </mat-card>
    </form>

    <form [formGroup]="locationDetails" autocomplete="off">
      <mat-card>
        <mat-card-title style="color: white; background-color: #014b88" ><h4 style="margin-left: 10px">Location Details</h4></mat-card-title >
        <div fxLayout="row" fxLayoutAlign="space-around  center">
        <div fxLayout="column" fxLayoutAlign="space-around  center">

          <mat-form-field appearance="fill">
            <mat-label>Discom Name</mat-label>

            <mat-select formControlName="discomName"  required (selectionChange)="fetchDiscomZone($event)" >
              <mat-option *ngFor="let item of discomList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>

            <mat-error
              *ngIf="locationDetails.controls['discomName'].hasError('required')"
            >
              Discom Name is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Zone</mat-label>
            <mat-select formControlName="zone" required  (selectionChange)="fetchZoneCity($event)" >
              <mat-option *ngFor="let item of zoneList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>

            <mat-error
              *ngIf="locationDetails.controls['zone'].hasError('required')"
            >
              Zone is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>City</mat-label>
            <mat-select formControlName="city"   (selectionChange)="fetchCityCircle($event)" >
              <mat-option *ngFor="let item of cityList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>

            <mat-error
              *ngIf="locationDetails.controls['city'].hasError('required')"
            >
              City is <strong>required</strong>
            </mat-error>
          </mat-form-field>


</div>

<div fxLayout="column" fxLayoutAlign="space-around  center">
          <mat-form-field appearance="fill">
            <mat-label>Circle</mat-label>
            <mat-select formControlName="circle"   (selectionChange)="fetchCircleDivision($event)" >
              <mat-option *ngFor="let item of circleList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>
            <mat-error
              *ngIf="locationDetails.controls['circle'].hasError('required')"
            >
              Circle is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Division</mat-label>
            <mat-select formControlName="division"   (selectionChange)="fetchDivisionSubDivision($event)" >
              <mat-option *ngFor="let item of divisionList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>
            <mat-error
              *ngIf="locationDetails.controls['division'].hasError('required')"
            >
            Division is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Sub-Division</mat-label>
            <mat-select formControlName="subdivision"    >
              <mat-option *ngFor="let item of subDivisionList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>
            <mat-error
              *ngIf="locationDetails.controls['subdivision'].hasError('required')"
            >
            Sub-Division is <strong>required</strong>
            </mat-error>
          </mat-form-field>

        </div>
        </div>

      </mat-card>
    </form>



    <form [formGroup]="applicationDetails" autocomplete="off">
      <mat-card fxLayout="column" fxFlex>
        <mat-card-title style="color: white; background-color: #014b88"> <h4 style="margin-left: 10px">Application Details</h4> </mat-card-title>

        <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="20px">

          <mat-form-field  appearance="fill">
            <mat-label>User Type</mat-label>
              <mat-select formControlName="userType"  required  >
              <mat-option *ngFor="let item of userTypeList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>
            <mat-error
              *ngIf="applicationDetails.controls['userType'].hasError('required')"
            >
            User Type is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field  appearance="fill">
            <mat-label>Request For</mat-label>
              <mat-select formControlName="requestFor"  required  >
              <mat-option *ngFor="let item of requestForList" [value]="item.shortCode">{{item.shortDescription}}</mat-option>
            </mat-select>
            <mat-error
              *ngIf="applicationDetails.controls['requestFor'].hasError('required')"
            >
            Request For is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Existing VPN User Name</mat-label>
            <input type="text" matInput formControlName="existingVPNName" />
            <mat-error
              *ngIf="applicationDetails.controls['existingVPNName'].hasError('required')"
            >
            VPN User Name is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>


      </mat-card>
    </form>
    <mat-divider></mat-divider>
    <mat-card>
      <!-- <mat-card-subtitle style="color: white; background-color: #014b88;">Application Access</mat-card-subtitle> -->
      <mat-card-title style="color: white; background-color: #014b88"
        ><h4 style="margin-left: 10px">Application Access</h4></mat-card-title
      >

      <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
        <mat-table  [dataSource]="appAccessDataSource" fxFlex>
          <!-- <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns">
            <mat-header-cell *matHeaderCellDef > {{column}} </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element[column]}} </mat-cell>
          </ng-container> -->
          <ng-container matColumnDef="sNo">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef

              class="TableHeader"
              >S.No</mat-header-cell
            >
            <mat-cell
              fxLayoutAlign="center center"
              *matCellDef="let element; let i = index"
              class="TableDataCell"
            >
              {{ i + 1 }}
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="applciationName">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef

              class="TableHeader"
              >Application Name</mat-header-cell
            >
            <mat-cell
              fxLayoutAlign="center center"
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
            >
              <!-- <mat-select formControlName="state" (selectionChange)="fetchPermissions($event)"  required> -->
              <mat-form-field appearance="outline">
                <input
                  matInput
                  placeholder="Application Name"
                  formControlName="applicationName"
                />
              </mat-form-field>
              <!-- <mat-form-field  appearance="outline">
                <mat-label>State</mat-label>

                  <mat-select formControlName="state"  required (selectionChange)="getDiscomDataForStateChange($event,i)" >

                  <mat-option *ngFor="let item of stateList" [value]="item.state">{{item.state}}</mat-option>
                </mat-select>
              </mat-form-field> -->
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="accesType">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef

              class="TableHeader"
              >Access Type</mat-header-cell
            >
            <mat-cell
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
              fxLayoutAlign="center center"
            >
              <!-- <mat-form-field appearance="outline">
                <mat-select formControlName="accesType" required>
                  <mat-option value="ADMIN">ADMIN</mat-option>
                  <mat-option value="MANAGER">MANAGER</mat-option>
                  <mat-option value="VIEWER">VIEWER</mat-option>
                </mat-select>
              </mat-form-field> -->

              <mat-form-field appearance="outline">
                <input
                  matInput
                  placeholder="Access Type"
                  formControlName="accesType"
                />
              </mat-form-field>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="remarks">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef
              class="TableHeader"
              >Remarks</mat-header-cell
            >
            <mat-cell
              fxLayoutAlign="center center"
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
            >
              <mat-form-field appearance="fill">
                <textarea
                  matInput
                  placeholder="Remarks"
                  formControlName="remarks"
                ></textarea>
              </mat-form-field>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="status">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef
              class="TableHeader"
              >Status</mat-header-cell
            >
            <mat-cell
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
              fxLayoutAlign="center center"
            >
              <mat-form-field appearance="outline">
                <mat-label>Status</mat-label>
                <mat-select
                  formControlName="status"
                  required
                  [ngStyle]="{
                    'background-color':
                      element.getRawValue().status === 'Approved'
                        ? 'green'
                        : element.getRawValue().status === 'Reject'
                        ? 'red'
                        : 'yellow',
                    color:
                      element.getRawValue().status === 'Approved'
                        ? 'white'
                        : element.getRawValue().status === 'Reject'
                        ? 'white'
                        : 'black'
                  }"
                >
                  <mat-option
                    value="Approved"
                    style="background-color: green; color: white"
                    >Approved</mat-option
                  >
                  <mat-option
                    value="Reject"
                    style="background-color: red; color: white"
                  >
                    <span style="background-color: red; color: white">
                      Reject</span
                    >
                  </mat-option>
                  <mat-option value="Pending" style="background-color: yellow"
                    >Pending</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="range">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef

              class="TableHeader"
              >Range</mat-header-cell
            >
            <mat-cell
              fxLayoutAlign="center center"
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
            >
              <!-- <mat-date-range-input  [rangePicker]="picker" [min]="minDate"> -->
              <mat-date-range-input [rangePicker]="picker">
                <input
                  matStartDate
                  formControlName="start"
                  placeholder="Start date"
                />
                <input matEndDate formControlName="end" placeholder="End date" />
              </mat-date-range-input>

              <mat-error
                *ngIf="element.controls['start'].hasError('matDatepickerMin')"
              >
                Check Date Range
              </mat-error>
              <mat-error
                *ngIf="element.controls['end'].hasError('matDatepickerMin')"
              >
                Check Date Range
              </mat-error>

              <mat-datepicker-toggle
                matSuffix
                [for]="picker"
              ></mat-datepicker-toggle>
              <mat-date-range-picker #picker></mat-date-range-picker>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="action">
            <mat-header-cell
              fxLayoutAlign="center center"
              *matHeaderCellDef

              class="TableHeader"
              >Required</mat-header-cell
            >
            <mat-cell
              fxLayoutAlign="center center"
              *matCellDef="let element; let i = index"
              class="TableDataCell"
              [formGroup]="element"
            >
              <mat-checkbox
                color="primary"
                formControlName="isRequired"
              ></mat-checkbox>
            </mat-cell>
          </ng-container>
          <mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></mat-header-row>
          <!-- <mat-row
                matRipple
                *matRowDef="let row; columns: displayedColumns"
                (click)="showDetails(row)">
              </mat-row> -->
          <mat-row
            matRipple
            *matRowDef="let row; columns: displayedColumns; let i = index"
          ></mat-row>
        </mat-table>
      </div>
    </mat-card>
    <form [formGroup]="VPNDetails" autocomplete="off">
      <mat-card>

        <mat-card-title style="color: white; background-color: #014b88"> <h4 style="margin-left: 10px">System Details</h4> </mat-card-title>


        <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="20px">

          <mat-form-field appearance="fill">
            <mat-label>LAN MAC Address</mat-label>
            <input type="text" (keyup)="changedLANMacInput()" matInput formControlName="lanMACAddress" maxlength="17" />
            <mat-error
              *ngIf="VPNDetails.controls['lanMACAddress'].hasError('required')"
            >
            MAC Address is <strong>required</strong>
            </mat-error>
            <mat-error
              *ngIf="VPNDetails.controls['lanMACAddress'].hasError('pattern')"
            >
            MAC Address is <strong>Invalid</strong>
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Wifi MAC Address</mat-label>
            <input type="text" matInput formControlName="wifiMACAddress" (keyup)="changedWIFIMacInput()" maxlength="17"/>
            <mat-error
              *ngIf="VPNDetails.controls['wifiMACAddress'].hasError('required')"
            >
            MAC Address is <strong>required</strong>
            </mat-error>
            <mat-error
              *ngIf="VPNDetails.controls['wifiMACAddress'].hasError('pattern')"
            >
            MAC Address is <strong>Invalid</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>VPN Access From India</mat-label>
            <mat-select formControlName="vpnAccessFromIndia"  required (selectionChange)="vpnCountryChange($event)" >

              <mat-option  value="Yes">Yes</mat-option>
              <mat-option  value="No">No</mat-option>
            </mat-select>
            <mat-error
              *ngIf="VPNDetails.controls['vpnAccessFromIndia'].hasError('required')"
            >
            VPN Access From India is <strong>required</strong>
            </mat-error>
          </mat-form-field>


          <mat-form-field appearance="fill">
            <mat-label>Country Name</mat-label>
            <input type="text" matInput formControlName="countryName" />
            <mat-error
              *ngIf="VPNDetails.controls['countryName'].hasError('required')"
            >
            Country Name is <strong>required</strong>
            </mat-error>
          </mat-form-field>

        </div>
      </mat-card>
    </form>

    <div
    fxLayout="row"
    fxLayoutAlign="center center"
    style="margin: 20px"

    fxLayoutGap="30px"
  >
      <button  mat-raised-button type="button" color="primary" dir="rtl" fxFlexOffset="5" fxFlex="5" (click)="dataSaved.emit(1)">Back</button>
      <button  mat-raised-button type="button" color="primary" dir="rtl" fxFlexOffset="5"  (click)="saveData()">Save</button>
    </div>



<div class="overlay" *ngIf="spinner">
  <div class="spinner">
      <mat-progress-spinner diameter=50
                          mode="indeterminate"
                color="accent">
    </mat-progress-spinner>
  </div>
  </div>

</div>
